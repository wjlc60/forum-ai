define ("mod_forum/discussion_modern",["exports","jquery","core/auto_rows","core/custom_interaction_events","core/notification","core/templates","mod_forum/discussion","mod_forum/inpage_reply","mod_forum/lock_toggle","mod_forum/favourite_toggle","mod_forum/pin_toggle","mod_forum/selectors"],function(a,b,c,d,f,g,h,i,j,k,l,m){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=n(b);c=n(c);d=n(d);f=n(f);g=n(g);h=n(h);i=n(i);j=n(j);k=n(k);l=n(l);m=n(m);function n(a){return a&&a.__esModule?a:{default:a}}function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function p(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){o(h,d,e,f,g,"next",a)}function g(a){o(h,d,e,f,g,"throw",a)}f(void 0)})}}function q(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);if("function"==typeof Object.getOwnPropertySymbols){d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))}d.forEach(function(b){r(a,b,c[b])})}return a}function r(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var s=function(a){return a.closest(m.default.post.post)},t=function(a){return a.children().not(m.default.post.repliesContainer).find(m.default.post.forumCoreContent)},u=function(a){return a.children().filter(m.default.post.inpageReplyContainer)},v=function(a,b){var c=a.find(m.default.post.inpageReplyContent);c.slideDown({duration:150,queue:!1,complete:b}).css("display","none").fadeIn(150)},w=function(a,b){var c=a.find(m.default.post.inpageReplyContent);c.slideUp({duration:150,queue:!1,complete:b}).fadeOut(200)},x=function(a){return 0<a.find(m.default.post.inpageReplyContent).length},y=function(a,b,c){var d=t(c),e=d.find(m.default.post.forumSubject).text(),f=d.find(m.default.post.authorName).text(),h=q({postid:c.data("post-id"),reply_url:b.attr("data-href"),sesskey:M.cfg.sesskey,parentsubject:e,parentauthorname:f,canreplyprivately:b.data("can-reply-privately"),postformat:i.default.CONTENT_FORMATS.MOODLE},a);return g.default.render("mod_forum/inpage_reply_modern",h)},z=function(a,h){d.default.define(a,[d.default.events.activate]);c.default.init(a);a.on(d.default.events.activate,m.default.post.inpageReplyCreateButton,function(){var a=p(regeneratorRuntime.mark(function a(c,d){var e,i,j,k;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:d.originalEvent.preventDefault();e=(0,b.default)(c.currentTarget);i=s(e);j=u(i);if(x(j)){a.next=15;break}a.prev=5;a.next=8;return y(h,e,i);case 8:k=a.sent;g.default.appendNodeContents(j,k,"");a.next=15;break;case 12:a.prev=12;a.t0=a["catch"](5);f.default.exception(a.t0);case 15:e.fadeOut(150,function(){v(j,function(){j.find(m.default.post.inpageReplyContent).find("textarea").focus()})});case 16:case"end":return a.stop();}}},a,null,[[5,12]])}));return function(){return a.apply(this,arguments)}}());a.on(d.default.events.activate,m.default.post.inpageReplyCancelButton,function(a,c){c.originalEvent.preventDefault();var d=(0,b.default)(a.currentTarget),e=s(d),f=t(e),g=u(e),h=f.find(m.default.post.inpageReplyCreateButton);w(g,function(){h.fadeIn(150)})})},A=function(a,b){z(a,b);h.default.init(a);i.default.init(a);var c=a.find("[data-container=\"discussion-tools\"]");j.default.init(c);k.default.init(c);l.default.init(c)};a.init=A});
//# sourceMappingURL=discussion_modern.min.js.map
