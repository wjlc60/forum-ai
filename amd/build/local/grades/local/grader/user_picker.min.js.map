{"version":3,"sources":["../../../../../src/local/grades/local/grader/user_picker.js"],"names":["renderNavigator","Templates","render","renderUserChange","context","showUser","root","users","currentUserIndex","showUserCallback","user","total","length","displayIndex","Promise","all","html","userRegion","querySelector","Selectors","regions","replaceNodeContents","bindEvents","saveUserCallback","addEventListener","e","button","target","closest","actions","changeUser","parseInt","dataset","direction","buildPicker","currentUserID","document","createElement","findIndex","id"],"mappings":"oNAwBA,OACA,O,ouCAEMA,CAAAA,CAAe,CAAG,UAAM,CAC1B,MAAOC,WAAUC,MAAV,CAAiB,iDAAjB,CAAoE,EAApE,CACV,C,CAEKC,CAAgB,CAAG,SAACC,CAAD,CAAa,CAClC,MAAOH,WAAUC,MAAV,CAAiB,sDAAjB,CAAyEE,CAAzE,CACV,C,CAEKC,CAAQ,4CAAG,WAAMC,CAAN,CAAYC,CAAZ,CAAmBC,CAAnB,CAAqCC,CAArC,iGACPC,CADO,MAENH,CAAK,CAACC,CAAD,CAFC,EAGTG,KAAK,CAAEJ,CAAK,CAACK,MAHJ,CAITC,YAAY,CAAEL,CAAgB,CAAG,CAJxB,kBAMQM,CAAAA,OAAO,CAACC,GAAR,CAAY,CAACZ,CAAgB,CAACO,CAAD,CAAjB,CAAyBD,CAAgB,CAACC,CAAD,CAAzC,CAAZ,CANR,0BAMNM,CANM,MAOPC,CAPO,CAOMX,CAAI,CAACY,aAAL,CAAmBC,UAAUC,OAAV,CAAkBH,UAArC,CAPN,CAQbhB,UAAUoB,mBAAV,CAA8BJ,CAA9B,CAA0CD,CAA1C,CAAgD,EAAhD,EARa,wCAAH,uD,CAWRM,CAAU,CAAG,SAAChB,CAAD,CAAOC,CAAP,CAAcC,CAAd,CAAgCC,CAAhC,CAAkDc,CAAlD,CAAuE,CACtFjB,CAAI,CAACkB,gBAAL,CAAsB,OAAtB,CAA+B,SAACC,CAAD,CAAO,CAClC,GAAMC,CAAAA,CAAM,CAAGD,CAAC,CAACE,MAAF,CAASC,OAAT,CAAiBT,UAAUU,OAAV,CAAkBC,UAAnC,CAAf,CACA,GAAIJ,CAAJ,CAAY,CACRH,CAAgB,CAAChB,CAAK,CAACC,CAAD,CAAN,CAAhB,CACAA,CAAgB,EAAIuB,QAAQ,CAACL,CAAM,CAACM,OAAP,CAAeC,SAAhB,CAA5B,CACA5B,CAAQ,CAACC,CAAD,CAAOC,CAAP,CAAcC,CAAd,CAAgCC,CAAhC,CACX,CACJ,CAPD,CAQH,C,CAEYyB,CAAW,4CAAG,WAAM3B,CAAN,CAAa4B,CAAb,CAA4B1B,CAA5B,CAA8Cc,CAA9C,iGACnBjB,CADmB,CACZ8B,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CADY,gBAGFvB,CAAAA,OAAO,CAACC,GAAR,CAAY,CAACf,CAAe,EAAhB,CAAZ,CAHE,0BAGhBgB,CAHgB,MAIvBf,UAAUoB,mBAAV,CAA8Bf,CAA9B,CAAoCU,CAApC,CAA0C,EAA1C,EAEMR,CANiB,CAMED,CAAK,CAAC+B,SAAN,CAAgB,SAAC5B,CAAD,CAAU,CAC/C,MAAOA,CAAAA,CAAI,CAAC6B,EAAL,GAAYR,QAAQ,CAACI,CAAD,CAC9B,CAFwB,CANF,iBAUjB9B,CAAAA,CAAQ,CAACC,CAAD,CAAOC,CAAP,CAAcC,CAAd,CAAgCC,CAAhC,CAVS,SAYvBa,CAAU,CAAChB,CAAD,CAAOC,CAAP,CAAcC,CAAd,CAAgCC,CAAhC,CAAkDc,CAAlD,CAAV,CAZuB,yBAchBjB,CAdgB,2CAAH,uD","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module will tie together all of the different calls the gradable module will make.\n *\n * @module     mod_forum/local/grades/local/grader/user_picker\n * @package    mod_forum\n * @copyright  2019 Mathew May <mathew.solutions>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Templates from 'core/templates';\nimport Selectors from './user_picker/selectors';\n\nconst renderNavigator = () => {\n    return Templates.render('mod_forum/local/grades/local/grader/user_picker', {});\n};\n\nconst renderUserChange = (context) => {\n    return Templates.render('mod_forum/local/grades/local/grader/user_picker/user', context);\n};\n\nconst showUser = async(root, users, currentUserIndex, showUserCallback) => {\n    const user = {\n        ...users[currentUserIndex],\n        total: users.length,\n        displayIndex: currentUserIndex + 1,\n    };\n    const [html] = await Promise.all([renderUserChange(user), showUserCallback(user)]);\n    const userRegion = root.querySelector(Selectors.regions.userRegion);\n    Templates.replaceNodeContents(userRegion, html, '');\n};\n\nconst bindEvents = (root, users, currentUserIndex, showUserCallback, saveUserCallback) => {\n    root.addEventListener('click', (e) => {\n        const button = e.target.closest(Selectors.actions.changeUser);\n        if (button) {\n            saveUserCallback(users[currentUserIndex]);\n            currentUserIndex += parseInt(button.dataset.direction);\n            showUser(root, users, currentUserIndex, showUserCallback);\n        }\n    });\n};\n\nexport const buildPicker = async(users, currentUserID, showUserCallback, saveUserCallback) => {\n    let root = document.createElement('div');\n\n    const [html] = await Promise.all([renderNavigator()]);\n    Templates.replaceNodeContents(root, html, '');\n\n    const currentUserIndex = users.findIndex((user) => {\n        return user.id === parseInt(currentUserID);\n    });\n\n    await showUser(root, users, currentUserIndex, showUserCallback);\n\n    bindEvents(root, users, currentUserIndex, showUserCallback, saveUserCallback);\n\n    return root;\n};\n"],"file":"user_picker.min.js"}